<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="zh-TW" xml:lang="zh-TW" xmlns="http://www.w3.org/1999/xhtml">
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 
 <title> Linux 的 Database-SQL-RDBMS HOWTO 文件 (PostgreSQL 物件關聯資料庫系統): 快速開始指引</title>
 <link href="PostgreSQL-HOWTO-8.html" rel="next" />
 <link href="PostgreSQL-HOWTO-6.html" rel="previous" />
  <link href="index.html" rel="start" title="HOWTO：Database-SQL-RDBMS HOWTO for Linux" />
 <link href="index.html#content" rel="contents" />
 <link href="index.html#appendix" rel="appendix" title="附錄" />
 <link href="http://www2.tw.postgresql.org/" rel="alternate" title="來源處" />
 <link href="PostgreSQL-HOWTO-1.html" rel="chapter" title="1.引言" />
 <link href="PostgreSQL-HOWTO-2.html" rel="chapter" title="2.物理定律適用於電腦軟件！" />
 <link href="PostgreSQL-HOWTO-3.html" rel="chapter" title="3.PostgreSQL 是什麼？" />
 <link href="PostgreSQL-HOWTO-4.html" rel="chapter" title="4.哪個較好？PostgreSQL 還是 MySQL？" />
 <link href="PostgreSQL-HOWTO-5.html" rel="chapter" title="5.何處取得 ?" />
 <link href="PostgreSQL-HOWTO-6.html" rel="chapter" title="6.PostgreSQL 快速安裝指引" />
 <link href="PostgreSQL-HOWTO-7.html" rel="chapter" title="7.快速開始指引" />
 <link href="PostgreSQL-HOWTO-8.html" rel="chapter" title="8.PostgreSQL 支援超過 200 Gig 的超級資料庫" />
 <link href="PostgreSQL-HOWTO-9.html" rel="chapter" title="9.憑什麼相信 PostgreSQL？Regression 測試套件為用戶建立信心" />
 <link href="PostgreSQL-HOWTO-10.html" rel="chapter" title="10.資料庫保安" />
 <link href="PostgreSQL-HOWTO-11.html" rel="chapter" title="11.PostgreSQL 的前端 GUI 工具（圖像使用者界面）" />
 <link href="PostgreSQL-HOWTO-12.html" rel="chapter" title="12.PostgreSQL 的介面驅動程式" />
 <link href="PostgreSQL-HOWTO-13.html" rel="chapter" title="13.PostgreSQL 的 Perl 資料庫介面 (Database Interface, DBI) " />
 <link href="PostgreSQL-HOWTO-14.html" rel="chapter" title="14.PostgreSQL 管理工具 " />
 <link href="PostgreSQL-HOWTO-15.html" rel="chapter" title="15.PostgreSQL 用的中央處理器" />
 <link href="PostgreSQL-HOWTO-16.html" rel="chapter" title="16.只使用一個顯示器 (monitor) 來設定多台 PostgreSQL 電腦" />
 <link href="PostgreSQL-HOWTO-17.html" rel="chapter" title="17.PostgreSQL 的萬維網應用程式伺服器" />
 <link href="PostgreSQL-HOWTO-18.html" rel="chapter" title="18.PostgreSQL 的應用程式和工具" />
 <link href="PostgreSQL-HOWTO-19.html" rel="chapter" title="19.資料庫設計工具—實體關係圖 (Entity Relation Tool) 工具" />
 <link href="PostgreSQL-HOWTO-20.html" rel="chapter" title="20.PostgreSQL 的互聯網資料庫設計/完成工具—EARP" />
 <link href="PostgreSQL-HOWTO-21.html" rel="chapter" title="21.PHP Hypertext PreProcessor—PostgreSQL 的伺服器端 html 嵌入命令稿語言" />
 <link href="PostgreSQL-HOWTO-22.html" rel="chapter" title="22.PostgreSQL 的 Python 介面" />
 <link href="PostgreSQL-HOWTO-23.html" rel="chapter" title="23.PostgreSQL 和萬維網的閘路 (gateway) — WDB-P95" />
 <link href="PostgreSQL-HOWTO-24.html" rel="chapter" title="24.&quot;C&quot;, &quot;C++&quot;, ESQL/C 語言介面和 PostgreSQL 的逐位運算元 (Bitwise Operators)" />
 <link href="PostgreSQL-HOWTO-25.html" rel="chapter" title="25.PostgreSQL 的日文假名碼 (Kanji Code)" />
 <link href="PostgreSQL-HOWTO-26.html" rel="chapter" title="26.移植 PostgreSQL 到視窗 95 / 視窗 NT" />
 <link href="PostgreSQL-HOWTO-27.html" rel="chapter" title="27.通信論壇" />
 <link href="PostgreSQL-HOWTO-28.html" rel="chapter" title="28.文件和參考書" />
 <link href="PostgreSQL-HOWTO-29.html" rel="chapter" title="29.PostgreSQL 的技術支援" />
 <link href="PostgreSQL-HOWTO-30.html" rel="chapter" title="30.經濟和商業方面" />
 <link href="PostgreSQL-HOWTO-31.html" rel="chapter" title="31.其他資料庫的名單" />
 <link href="PostgreSQL-HOWTO-32.html" rel="chapter" title="32.萬維網搜尋提示" />
 <link href="PostgreSQL-HOWTO-33.html" rel="chapter" title="33.結論" />
 <link href="PostgreSQL-HOWTO-34.html" rel="chapter" title="34.FAQ—有關 PostgreSQL 的問題" />
 <link href="PostgreSQL-HOWTO-35.html" rel="chapter" title="35.本文件的其他格式" />
 <link href="PostgreSQL-HOWTO-36.html" rel="chapter" title="36.版權和授權" />
 <link href="PostgreSQL-HOWTO-37.html" rel="appendix" title="附錄甲—ANSI/ISO SQL 1992 語法 " />
 <link href="PostgreSQL-HOWTO-38.html" rel="appendix" title="附錄乙—初學者 SQL 導引 " />
 <link href="PostgreSQL-HOWTO-39.html" rel="appendix" title="附錄丙—Linux 快速安裝指引 " />
 <link href="PostgreSQL-HOWTO-40.html" rel="appendix" title="附錄丁—安裝 Midgard" />
 <meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html"  labels ratings (ca 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html"  labels ratings (n 0 s 0 v 0 l 0))'/>
 <link href="PostgreSQL-HOWTO.rdf" rel="meta" title="各章節的說明資訊" />
 <link href="../../style.css" rel="stylesheet" type="text/css" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.1" rel="section" title="7.1 資料庫建立、丟棄、改名" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.2" rel="section" title="7.2 建立和丟棄用戶" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.3" rel="section" title="7.3 建立和丟棄群組" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.4" rel="section" title="7.4 建立、編輯和丟棄表格 " />
 <link href="PostgreSQL-HOWTO-7.html#ss7.5" rel="section" title="7.5 建立、編輯和丟棄表格中的紀錄" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.6" rel="section" title="7.6 改變目前的資料庫 " />
 <link href="PostgreSQL-HOWTO-7.html#ss7.7" rel="section" title="7.7 備份與還原資料庫" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.8" rel="section" title="7.8 資料庫保安 " />
 <link href="PostgreSQL-HOWTO-7.html#ss7.9" rel="section" title="7.9 線上求助 " />
 <link href="PostgreSQL-HOWTO-7.html#ss7.10" rel="section" title="7.10 建立激發 (Triggers) 和內儲程序 (Stored Procedures)" />
 <link href="PostgreSQL-HOWTO-7.html#ss7.11" rel="section" title="7.11 PostgreSQL 文件" />
</head> <body   > 
<table >
  <tr>
    <th colspan="3" class="HdTitle">HOWTO：Database-SQL-RDBMS
      HOWTO for Linux</th>
  </tr>
  <tr>
    <td class="TtdL"> <a href="PostgreSQL-HOWTO-6.html" accesskey="P">上一頁(P)</a> </td>
    <td class="TtdC">&nbsp;</td>
    <td class="TtdR"> <a href="PostgreSQL-HOWTO-8.html" accesskey="N">下一頁(N)</a> </td>
  </tr>
</table>
<hr />
<h1>7. 快速開始指引</h1>

<p>請參考
<a href="PostgreSQL-HOWTO-6.html#Quick-Installation">快速安裝指引</a>一章。</p>
<h2><a name="ss7.1" id="ss7.1"></a>7.1 資料庫建立、丟棄、改名
</h2>

<p>你可使用使用者友善的
GUI，名為‘pgaccess’來建立和丟棄資料庫，也可用指令列‘psql’工具。</p>
<pre class="sample">
如你以 root 身份登入，變身為用者‘postgres’︰
# xhost + （讓 pgaccess 使用顯示裝置）
# su - postgres
bash$ man createdb
bash$ createdb mydatabase
bash$ man psql
bash$ psql mydatabase
…在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s

bash$ export DISPLAY=&lt;主機名>:0.0
bash$ man pgaccess
bash$ pgaccess mydatabase
</pre>

<p>你現在可以在 psql 或 pgaccess 高速下達 SQL 指令。
</p>


<p>要丟棄資料庫的話︰</p>
<pre class="sample">
bash$ man dropdb
bash$ man destroydb  （在較舊版本的 pgsql 中使用） 
bash$ dropdb &lt;資料庫名稱>
</pre>

<p>也可以在一個 SQL 連接期間用以下指令消滅一個資料庫︰
</p>
<pre class="sample">
> drop database &lt;資料庫名稱>
</pre>

<p>要更改資料庫名稱，請參閱
  <a href="#backup_restore">備份和還原</a>一節
</p>

<h2><a name="ss7.2" id="ss7.2"></a>7.2 建立和丟棄用戶
</h2>

<p>要建立新用戶，以 unix 用戶‘postres’簽入，你可用簡單易用的 GUI
工具‘pgaccess’來增減用戶。</p>
<pre class="sample">
bash$ man pgaccess
bash$ pgaccess &lt;資料庫名稱>
</pre>

<p>擊選“Users”tab，再擊選 Object|New 或 Object|Delete
</p>

<p>你也可用指令行命令稿 (script)。名為‘createuser’的命令稿啟動 psql。</p>
<pre class="sample">
bash$ man createuser
bash$ createuser &lt;用戶名稱>
bash$ createuser -h host -p port -i userid &lt;用戶名稱>
</pre>
<p>要丟棄一個 postgres 用戶，使用命令稿‘destroyuser’。</p>
<pre class="sample">
bash$ man dropuser
bash$ man destroyuser （在較舊版本的 pgsql 中使用） 
bash$ destroyuser
</pre>
<h2><a name="ss7.3" id="ss7.3"></a>7.3 建立和丟棄群組
</h2>

<p>目前沒有簡單的介面可用來設定用戶群組。你要自行在 pg_group
表格中插入或更新紀錄。如︰</p>
<pre class="sample">
bash$ su - postgres
bash$ psql &lt;資料庫名稱>
…在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s

psql=> insert into pg_group (groname, grosysid, grolist)
psql=> values ('posthackers', '1234', '{5443, 8261}' );
INSERT 58224
psql=> grant insert on foo to group posthackers;
CHANGE
psql=>
</pre>

<p>pg_group 中的欄位為︰
  groname 群組名稱。這名稱必須全為字母或數字，不可有底線或標點符號。
</p>

<p>grosysid 群組代碼。這是一個 int4，每個群組都要獨一無二。</p>
<p>grolist 屬於此群組的 pg_user 代碼名單。是一個 int4[]。</p>
<p>要刪除群組︰</p>
<pre class="sample">
bash$ su - postgres
bash$ psql &lt;資料庫名稱>
…在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s


psql=> delete from pg_group where groname = 'posthackers';
</pre>
<h2><a name="ss7.4" id="ss7.4"></a>7.4 建立、編輯和丟棄表格
</h2>

<p>你可使用使用者友善的
GUI，名為‘pgaccess’，或指令列‘psql’工具來建立、編輯和丟棄資料庫表格。</p>
<pre class="sample">
bash$ man pgaccess
bash$ pgaccess &lt;資料庫名稱>
</pre>

<p>擊選 Table | New | Design 按鈕。</p>
<pre class="sample">
bash$ man psql
bash$ psql &lt;資料庫名稱>
…在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s
</pre>

<p>在 psql 提示下，鍵入標準的 SQL 指令，如‘create table’、‘alter
  table’或‘drop table’來處理表格。
</p>

<h2><a name="ss7.5" id="ss7.5"></a>7.5 建立、編輯和丟棄表格中的紀錄
</h2>


<p>你可使用使用者友善的
GUI，名為‘pgaccess’，或指令列‘psql’工具來建立、
編輯和丟棄資料庫表格中的紀錄。</p>
<pre class="sample">
bash$ man pgaccess
bash$ pgaccess &lt;資料庫名稱>
</pre>

<p>擊選 Table | &lt; 選一個表格 &gt; | Open 按鈕。 </p>
<pre class="sample">
bash$ man psql
bash$ psql &lt;資料庫名稱>
…在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s
</pre>

<p>在 psql 提示下，鍵入標準的 SQL 指令，如‘insert into table_name’、‘update
  table_name’或‘delete from table_name’來處理表格。
</p>

<h2><a name="ss7.6" id="ss7.6"></a>7.6 改變目前的資料庫
</h2>

<p>你可使用使用者友善的
GUI，名為‘pgaccess’，或指令列‘psql’工具來改變目前的資料庫。</p>
<pre class="sample">
bash$ man pgaccess
bash$ pgaccess &lt;資料庫名稱>
</pre>

<p>擊選 Database | Open 按鈕。
</p>
<pre class="sample">
bash$ man psql
bash$ psql &lt;資料庫名稱>
…在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s

psql=> connect &lt;資料庫名稱> &lt;user>
</pre>
<h2> <a name="ss7.7" id="ss7.7"></a>7.7 備份與還原資料庫 
</h2>

<p>PostgreSQL 提供了兩個工具來備份你的系統︰pg_dump 
備份一個資料庫，pg_dumpall 一次過備份所有資料庫。</p>
<pre class="sample">
bash$ su - postgres
bash$ man pd_dump
bash$ pd_dump &lt;資料庫名稱> > database_name.pgdump
</pre>

<p>還原則︰</p>
<pre class="sample">
bash$ cat database_name.pgdump | psql &lt;資料庫名稱>
</pre>

<p>這技考可用於搬移資料庫或為資料庫改名。
</p>

<p>警告︰每個資料庫都要定時備份。因為 PostgreSQL
自行管理它在檔案系統中的檔案，所以不要倚賴系統備份來作資料庫備份。
沒有人能保證那些檔案在還原後會處於一個可用而一致的狀態。</p>
<p>備份大型資料庫︰因為 PostreSQL
容許表格大過系統的最大檔案容量，把一個表格輸出為一個檔案會有問題，
因為所產生的檔案可能會超出系統的限制。因為 pg_dump 會寫到 
stdout，你可使用標準的 unix 工具來解決這可能的問題︰</p>
<p>使用壓縮了的輸出︰</p>
<pre class="sample">
bash$ pg_dump &lt;資料庫名稱> | gzip > filename.dump.gz
</pre>

<p>用以下方法重新載入︰
</p>
<pre class="sample">
bash$ createdb &lt;資料庫名稱>
bash$ gunzip -c filename.dump.gz | psql &lt;資料庫名稱>
</pre>

<p>或
</p>
<pre class="sample">
bash$ cat filename.dump.gz | gunzip | psql &lt;資料庫名稱
</pre>
<p>使用 split︰</p>
<pre class="sample">
bash$ pg_dump &lt;資料庫名稱> | split -b 1m - filename.dump.
</pre>

<p>注意︰以上指令中，在 filename.dump 後有一點 (.)！！你可用以下方法重新載入︰</p>
<pre class="sample">
bash$ man createdb
bash$ createdb &lt;資料庫名稱>
bash$ cat filename.dump.* | pgsql &lt;資料庫名稱>
</pre>

<p>當然，檔案名稱（filename）和 pg_dump
  輸出的內容無需和資料庫名稱配合。此外，還原了的資料庫可有任何新名。
  因此這方法適用於為資料庫改名。
</p>

<p>要把所有 PostgreSQL 輸出，使用 pg_dumpall</p>
<pre class="sample">
bash$ man pg_dumpall
bash$ pg_dumpall -o > db.out
要重新載入︰
bash$ psql -e template1 &lt; db.out

</pre>
<h2><a name="ss7.8" id="ss7.8"></a>7.8 資料庫保安
</h2>

<p>請參閱
<a href="PostgreSQL-HOWTO-10.html#security">PostgreSQL 保安</a>一節。</p>

<h2><a name="ss7.9" id="ss7.9"></a>7.9 線上求助
</h2>

<p>你必須知道 PostgreSQL
的線上求助設施，因為它會為你節省很多時間，讓你快速取得資料。</p>
<p>請參閱不同指令，如 createdb、createuser 等等的線上  man pages。</p>
<pre class="sample">
bash$ man createdb</pre>
<p>也請參閱 psql 的線上求助訊息，在 psql 提示鍵入 \h</p>
<pre class="sample">
bash$ psql mydatabase
psql> \h
提示︰在 psql 按上 / 下箭咀來編輯歷史紀錄或用 \s

</pre>
<h2><a name="ss7.10" id="ss7.10"></a>7.10 建立激發 (Triggers) 和內儲程序 (Stored Procedures)
</h2>

<p>要建立激發或內儲程序，先在你使用的資料庫執行‘createlang’命令稿來安裝
‘plpgsql’。如果你想預設使用它，把它安裝在‘template1’，
因為以後建立的資料庫都是 template1 的仿裝品。參閱‘createlang’網頁或位於 
/usr/doc/postgresql-7.0.2/user/index.html 的 User Guide。</p>
<pre class="sample">
bash$ man createlang
bash$ createdb mydb
bash$ export PGLIB=/usr/lib/pgsql
bash$ createlang plpgsql mydb
bash$ createlang plpgsql template1
</pre>

<p>也請參考 
  <a href="PostgreSQL-HOWTO-6.html#Examples RPM">例子 RPM</a> 
中激發和內儲程序的例子。Examples RPM 中的其中一個例子︰
</p>
<pre class="sample">
create function tg_pfield_au() returns opaque as '
begin
    if new.name != old.name then
        update PSlot set pfname = new.name where pfname = old.name;
    end if;
    return new;
end;
' language 'plpgsql';

create trigger tg_pfield_au after update
    on PField for each row execute procedure tg_pfield_au();
</pre>

<p>另一個激發程式碼例子︰
</p>
<pre class="sample">
create trigger check_fkeys_pkey_exist
        before insert or update on fkeys
        for each row
        execute procedure
        check_primary_key ('fkey1', 'fkey2', 'pkeys', 'pkey1', 'pkey2');
</pre>

<p>你必須安裝 TEST 套件— postgresql-test-7.0.2-2.rpm 和閱讀在 
  /usr/lib/pgsql/test/regress/sql 中的 SQL 命令稿例子。
</p>

<p>要顯示資料庫中激發的名單—</p>
<pre class="sample">
bash$ psql mydb
psql=> \?
psql=> \dS
psql=> \d pg_trigger
psql=> select tgname from pg_trigger order by tgname;
</pre>
<p>要顯示資料庫中函數和內儲程序的名單—</p>
<pre class="sample">
bash$ psql mydb
psql=> \?
psql=> \dS
psql=> \d pg_proc
psql=> select proname, prosrc from pg_proc order by proname;
psql=> \df
</pre>
<h2><a name="ss7.11" id="ss7.11"></a>7.11 PostgreSQL 文件
</h2>

<p>有關其他問題，請參閱 PostgreSQL 的說明書，它們的資料十分全面。PostgreSQL
文件已在套件中。請閱讀‘User's Guide’、‘Programmer's
Guide’、‘Administrator's Guide’和其他說明書。</p>
<hr />
<div> <a href="http://validator.w3.org/check/referer"><img src="../../../valid-xhtml10.png"  alt="符合 XHTML 1.0" class="ImgLogo"/></a> <a href="http://jigsaw.w3.org/css-validator/"><img class="ImgLogo" src="../../../vcss.png"  alt="符合 CSS"/></a> <a href="http://www.icra.org/_en/"><img src="../../../icra_sw.gif" title="網路內容分級協會" alt="網路內容分級協會" class="ImgLogo"/></a></div>
</body>
</html>
