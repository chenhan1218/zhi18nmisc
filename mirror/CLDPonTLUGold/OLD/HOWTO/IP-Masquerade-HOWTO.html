<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>Linux IP Masquerade HOWTO</TITLE>
 <LINK HREF="IP-Masquerade-HOWTO-1.html" REL=next>


<SCRIPT src="../menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(1, 8, 1);</SCRIPT>
<A HREF="IP-Masquerade-HOWTO-1.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<IMG SRC="../img/prev.gif" ALT="Previous">
<IMG SRC="../img/toc.gif" ALT="Contents">
<HR>
<H1>Linux IP Masquerade HOWTO</H1>

<H2>David Ranch, <CODE>
<A HREF="mailto:dranch@trinnet.net">dranch@trinnet.net</A></CODE></H2>v1.95, November 14, 2000
<P><HR>
<EM>This document describes how to enable the Linux IP Masquerade feature on a given Linux host.  IP Masq is a form of Network Address Translation or NAT that allows internally connected computers that do not have one or more registered Internet IP addresses to have the ability to communicate to the Internet via your Linux box's single Internet IP address. </EM>
<HR>
<P>
<H2><A NAME="toc1">1.</A> <A HREF="IP-Masquerade-HOWTO-1.html">Introduction</A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-1.html#ss1.1">1.1 Introduction to IP Masquerading or IP MASQ for short</A>
<LI><A HREF="IP-Masquerade-HOWTO-1.html#ss1.2">1.2 Foreword, Feedback &amp; Credits</A>
<LI><A HREF="IP-Masquerade-HOWTO-1.html#ss1.3">1.3 Copyright &amp; Disclaimer</A>
</UL>
<P>
<H2><A NAME="toc2">2.</A> <A HREF="IP-Masquerade-HOWTO-2.html">Background Knowledge</A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.1">2.1 What is IP Masquerade?</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.2">2.2 Current Status</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.3">2.3 Who Can Benefit From IP Masquerade?</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.4">2.4 Who Doesn't Need IP Masquerade?</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.5">2.5 How does IP Masquerade Work?</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.6">2.6 Requirements for IP Masquerade on Linux 2.2.x</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.7">2.7 Requirements for IP Masquerade on Linux 2.3.x and 2.4.x</A>
<LI><A HREF="IP-Masquerade-HOWTO-2.html#ss2.8">2.8 Requirements for IP Masquerade on Linux 2.0.x</A>
</UL>
<P>
<H2><A NAME="toc3">3.</A> <A HREF="IP-Masquerade-HOWTO-3.html">Setting Up IP Masquerade</A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-3.html#ss3.1">3.1 Compiling the Kernel for IP Masquerade Support</A>
<LI><A HREF="IP-Masquerade-HOWTO-3.html#ss3.2">3.2 Assigning Private Network IP Addresses to the Internal LAN</A>
<LI><A HREF="IP-Masquerade-HOWTO-3.html#ss3.3">3.3 Configuring IP Forwarding Policies</A>
</UL>
<P>
<H2><A NAME="toc4">4.</A> <A HREF="IP-Masquerade-HOWTO-4.html">Configuring the other internal to-be MASQed machines </A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.1">4.1 Configuring Microsoft Windows 95</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.2">4.2 Configuring Windows NT</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.3">4.3 Configuring Windows for Workgroup 3.11</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.4">4.4 Configuring UNIX Based Systems</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.5">4.5 Configuring DOS using NCSA Telnet package</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.6">4.6 Configuring MacOS Based System Running MacTCP</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.7">4.7 Configuring MacOS Based System Running Open Transport </A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.8">4.8 Configuring Novell network using DNS</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.9">4.9 Configuring OS/2 Warp</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.10">4.10 Configuring OS/400 on a IBM AS/400</A>
<LI><A HREF="IP-Masquerade-HOWTO-4.html#ss4.11">4.11 Configuring Other Systems</A>
</UL>
<P>
<H2><A NAME="toc5">5.</A> <A HREF="IP-Masquerade-HOWTO-5.html">Testing IP Masquerade </A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.1">5.1 Testing local PC connectivity</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.2">5.2 Testing internal Linux connectivity</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.3">5.3 Testing External Linux connectivity</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.4">5.4 Testing local PC to Linux connectivity</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.5">5.5 Testing internal MASQ ICMP forwarding </A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.6">5.6 Testing external MASQ ICMP forwarding </A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.7">5.7 Testing MASQ functionality without DNS</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.8">5.8 Testing MASQ functionality with DNS</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.9">5.9 Testing more MASQ functionality with DNS</A>
<LI><A HREF="IP-Masquerade-HOWTO-5.html#ss5.10">5.10 Any remaining functional, performance, etc. issues...</A>
</UL>
<P>
<H2><A NAME="toc6">6.</A> <A HREF="IP-Masquerade-HOWTO-6.html">Other IP Masquerade Issues and Software Support </A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.1">6.1 Problems with IP Masquerade </A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.2">6.2 Incoming services </A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.3">6.3 Supported Client Software and Other Setup Notes</A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.4">6.4 Stronger IP Firewall (IPFWADM) Rulesets</A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.5">6.5 Stronger IP Firewall (IPCHAINS) rulesets </A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.6">6.6 IP Masquerading multiple internal networks</A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.7">6.7 IP Masquerade and Dial-on-Demand Connections</A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.8">6.8 IPPORTFW, IPMASQADM, IPAUTOFW, REDIR, UDPRED, and other Port Forwarding tools </A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.9">6.9 CU-SeeMe and Linux IP-Masquerade</A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.10">6.10 Mirabilis ICQ </A>
<LI><A HREF="IP-Masquerade-HOWTO-6.html#ss6.11">6.11 Gamers:  The LooseUDP patch</A>
</UL>
<P>
<H2><A NAME="toc7">7.</A> <A HREF="IP-Masquerade-HOWTO-7.html">Frequently Asked Questions</A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.1">7.1 What Linux Distributions support IP Masquerading out of the box?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.2">7.2 What are the minimum hardware requirements and any limitations for IP Masquerade?  How well does it perform?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.3">7.3 When I run the rc.firewall command, I get "command not found" errors.  Why?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.4">7.4 I've checked all my configurations, I still can't get IP Masquerade to work.  What should I do?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.5">7.5 How do I join or view the IP Masquerade and/or IP Masqurade Developers mailing lists and archives?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.6">7.6 How does IP Masquerade differ from Proxy or NAT services? </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.7">7.7 Are there any GUI firewall creation/management tools? </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.8">7.8 Does IP Masquerade work with dynamically assigned IP addresses? </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.9">7.9 Can I use a cable modem (both bi-directional and with modem returns), DSL, satellite link, etc. to connect to the Internet and use IP Masquerade?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.10">7.10 Can I use Diald or the Dial-on-Demand feature of PPPd with IP MASQ?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.11">7.11 What applications are supported with IP Masquerade?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.12">7.12 How can I get IP Masquerade running on Redhat, Debian, Slackware, etc.? </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.13">7.13 TELNET connections seem to break if I don't use them often.  Why is that? </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.14">7.14 When my Internet connection first comes up, nothing works.  If I try again, everything then works fine.  Why is this?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.15">7.15 ( MTU ) - IP MASQ seems to be working fine but some sites don't work.  This usually happens with WWW and FTP.</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.16">7.16 MASQed FTP clients don't work. </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.17">7.17 IP Masquerading seems slow</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.18">7.18 IP Masquerading with PORTFWing seems to break when my line is idle for long periods</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.19">7.19 Now that I have IP Masquerading up, I'm getting all sorts of weird notices and errors in the SYSLOG log files.  How do I read the IPFWADM/IPCHAINS firewall errors?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.20">7.20 Can I configure IP MASQ to allow Internet users to directly contact internal MASQed servers?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.21">7.21 I'm getting "kernel: ip_masq_new(proto=UDP): no free ports." in my SYSLOG files.  Whats up?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.22">7.22 I'm getting "ipfwadm: setsockopt failed: Protocol not available" when I try to use IPPORTFW! </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.23">7.23 ( SAMBA ) - Microsoft File and Print Sharing and Microsoft Domain clients don't work through IP Masq! To properly support Microsoft's SMB protocol, a IP Masq module would need to be written but there are three viable work-arounds.</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.24">7.24 ( IDENT ) - IRC won't work properly for MASQed IRC users.  Why?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.25">7.25 ( DCC ) - mIRC doesn't work with DCC Sends</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.26">7.26 ( IP Aliasing ) - Can IP Masquerade work with only ONE Ethernet network card?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.27">7.27 ( MULTI-LAN ) - I have two MASQed LANs but they cannot communicate with eachother!</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.28">7.28 ( SHAPING ) - I want to be able to limit the speed of specific types of traffic</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.29">7.29 ( ACCOUNTING ) -  I need to do accounting on who is using the network</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.30">7.30 ( MULTIPLE IPs ) -  I have several EXTERNAL IP addresses that I want to</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.31">7.31 I'm trying to use the NETSTAT command to show my Masqueraded connections but its not working</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.32">7.32 ( VPNs ) - I would like to get Microsoft PPTP (GRE tunnels) and/or IPSEC (Linux SWAN) tunnels running through IP MASQ </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.33">7.33 I want to get the XYZ network game to work through IP MASQ but it won't work.  Help!</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.34">7.34 IP MASQ works fine for a while but then it stops working.  A reboot seems to fix this for a while.  Why?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.35">7.35 Internal MASQed computers cannot send SMTP or POP-3 mail!</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.36">7.36 ( IPROUTE2 ) - I need different internal MASQed networks to exit on different external IP addresses</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.37">7.37 Why do the new 2.1.x and 2.2.x kernels use IPCHAINS instead of IPFWADM?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.38">7.38 I've just upgraded to the 2.2.x kernels, why isn't IP Masquerade working?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.39">7.39 I've just upgraded to a 2.0.38+ kernels later, why isn't IP Masquerade working?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.40">7.40 I need help with EQL connections and IP Masq</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.41">7.41 I can't get IP Masquerade to work!  What options do I have for Windows Platforms?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.42">7.42 I want to help on IP Masquerade development.  What can I do?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.43">7.43 Where can I find more information on IP Masquerade? </A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.44">7.44 I want to translate this HOWTO to another language, what should I do?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.45">7.45 This HOWTO seems out of date, are you still maintaining it?  Can you include more information on ...?  Are there any plans for making this better?</A>
<LI><A HREF="IP-Masquerade-HOWTO-7.html#ss7.46">7.46 I got IP Masquerade working, it's great!  I want to thank you guys, what can I do?</A>
</UL>
<P>
<H2><A NAME="toc8">8.</A> <A HREF="IP-Masquerade-HOWTO-8.html">Miscellaneous</A></H2>

<UL>
<LI><A HREF="IP-Masquerade-HOWTO-8.html#ss8.1">8.1 Useful Resources </A>
<LI><A HREF="IP-Masquerade-HOWTO-8.html#ss8.2">8.2 Linux IP Masquerade Resource </A>
<LI><A HREF="IP-Masquerade-HOWTO-8.html#ss8.3">8.3 Thanks to the following people..</A>
<LI><A HREF="IP-Masquerade-HOWTO-8.html#ss8.4">8.4 Reference </A>
<LI><A HREF="IP-Masquerade-HOWTO-8.html#ss8.5">8.5 Changes </A>
</UL>
<HR>
<A HREF="IP-Masquerade-HOWTO-1.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<IMG SRC="../img/prev.gif" ALT="Previous">
<IMG SRC="../img/toc.gif" ALT="Contents">
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
