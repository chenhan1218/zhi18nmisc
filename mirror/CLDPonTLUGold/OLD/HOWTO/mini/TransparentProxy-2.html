<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE>Transparent Proxy with Squid mini-HOWTO: Overview of Transparent Proxying</TITLE>
 <LINK HREF="TransparentProxy-3.html" REL=next>
 <LINK HREF="TransparentProxy-1.html" REL=previous>
 <LINK HREF="TransparentProxy.html#toc2" REL=contents>
<SCRIPT src="../../menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(2, 8, 2);</SCRIPT>
<A HREF="TransparentProxy-3.html"><IMG SRC="../../img/next.gif" ALT="Next"></A>
<A HREF="TransparentProxy-1.html"><IMG SRC="../../img/prev.gif" ALT="Previous"></A>
<A HREF="TransparentProxy.html#toc2"><IMG SRC="../../img/toc.gif" ALT="Contents"></A>
<HR>
<H2><A NAME="s2">2. Overview of Transparent Proxying</A></H2>

<H2><A NAME="ss2.1">2.1 Motivation</A>
</H2>

<P>In ``ordinary'' proxying, the client specifies the hostname and port number
of a proxy in his web browsing software. The browser then makes requests to
the proxy, and the proxy forwards them to the origin servers. This is all fine
and good, but sometimes one of several situations arise. Either
<P>
<UL>
<LI>You want to force clients on your network to use the proxy, whether they
want to or not.</LI>
<LI>You want clients to use a proxy, but don't want them to know they're being
proxied.</LI>
<LI>You want clients to be proxied, but don't want to go to all the work of
updating the settings in hundreds or thousands of web browsers.</LI>
</UL>
<P>This is where transparent proxying comes in. A web request can be intercepted
by the proxy, transparently. That is, as far as the client software knows,
it is talking to the origin server itself, when it is really talking to
the proxy server.
<P>Cisco routers support transparent proxying. So do many switches. But, 
(surprisingly enough)
Linux can act as a router, and can perform transparent proxying by redirecting
TCP connections to local ports. However, we also need to make our web proxy
aware of the affect of the redirection, so that it can make connections to
the proper origin servers. There are two general ways this works:
<P>The first is when your web proxy is not transparent proxy aware. You can
use a nifty little daemon called transproxy that sits in front of your web
proxy and takes care of all the messy details for you. transproxy was written
by John Saunders, and is available from 
<P>
<A HREF="ftp://ftp.nlc.net.au/pub/linux/www/">ftp://ftp.nlc.net.au/pub/linux/www/</A>
or your local metalab mirror. transproxy will not be discussed further in this
document.
<P>A cleaner solution is to get a web proxy that is aware of transparent proxying
itself. The one we are going to focus on here is squid. Squid is an Open Source
caching proxy server for Unix systems. It is available from 
<A HREF="http://www.squid-cache.org">www.squid-cache.org</A><H2><A NAME="ss2.2">2.2 Scope of this document</A>
</H2>

<P>This document will focus on squid version 2.3 and linux kernel version
2.4, the most current stable releases as of this writing (Jan 2001). It should
also work with squids as early as 2.0, and most of the later 2.3 kernels.
If you need information about earlier releases, you may find some earlier 
documents at 
<A HREF="http://www.unxsoft.com">www.unxsoft.com</A>. 
<P>If you are using a development kernel or a development version of squid, you are on your own.  This document may help you, but YMMV.
<P>Note that this document focuses only on HTTP proxing.  I get many emails asking
about transparent FTP proxying. While it may not be theoretically impossible
to proxy FTP transparently, it is MUCH harder than HTTP, and I do not know 
of any currently available tools that can do it.  If you can figure it out, I
suggest you write your own HOWTO...
<HR>
<A HREF="TransparentProxy-3.html"><IMG SRC="../../img/next.gif" ALT="Next"></A>
<A HREF="TransparentProxy-1.html"><IMG SRC="../../img/prev.gif" ALT="Previous"></A>
<A HREF="TransparentProxy.html#toc2"><IMG SRC="../../img/toc.gif" ALT="Contents"></A>
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
