<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
 <META NAME="GENERATOR" CONTENT="ZH-SGML-Tools 1.0.9">
 <TITLE>中文 UPS Howto: 请注意已过时的资讯</TITLE>
 <LINK HREF="UPS-HOWTO-3.html" REL=next>
 <LINK HREF="UPS-HOWTO-1.html" REL=previous>
 <LINK HREF="UPS-HOWTO.html#toc2" REL=contents>
<SCRIPT src="menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(0, 2, 5);</SCRIPT>
<A HREF="UPS-HOWTO-3.html"><IMG SRC="img/next.gif" ALT="Next"></A>
<A HREF="UPS-HOWTO-1.html"><IMG SRC="img/prev.gif" ALT="Previous"></A>
<A HREF="UPS-HOWTO.html#toc2"><IMG SRC="img/toc.gif" ALT="Contents"></A>
<HR>
<H2><A NAME="s2">2. 请注意已过时的资讯</A></H2>

<P>我刚刚发现底下有一些资料已经过时了。其中来自
<A HREF="http://sunsite.unc.edu/pub/Linux/system/daemons/init/sysvinit-2.64.tar.gz">the latest sysvinit package</A>
的 <CODE>init</CODE> daemon 比起我所能描述的还要简陋。
尽管看起来目前的版本与该程式完成时的版本相容，但当中仍然有一些对 UPS
<B>相当重要</B> 的支援没有文件说明。
<P>底下所简述的控制机制只能让 <CODE>powerd</CODE> 送给 <CODE>init</CODE> <CODE>powerfail</CODE> 或
<CODE>powerok</CODE> 这两个讯息之一而已。<CODE>init</CODE> 接到 <CODE>powerfail</CODE> 
讯息时执行一个命令，而当它接到 <CODE>powerok</CODE> 时则执行另一个命令。
这将导至 <CODE>powerd</CODE> 在处理低电力讯号及其他特殊状况时产生逻辑上的复杂性。
<P>较新版本的 <CODE>init</CODE> (像是 2.58 版) 就比较精良了。
它可以在接到讯号时选择 <CODE>三个</CODE> script 中之一来执行。如此一来， <CODE>init</CODE>
可以在接到电源断电讯号时执行 <CODE>powerfail</CODE> script ，可以执行一个
<CODE>powerfailnow</CODE> script 做立即的关机 ，以及一个 <CODE>powerok</CODE> script
来停止任何正在进行的关机动作。这样比起要我们自行处理这些机制要简单多了。
<P>尽管这□大部分的讨论仍假设使用旧的 <CODE>init</CODE> 通讯方式，
我已加入了两个新的章节来描述新的连线方法。这两个章节是 
<@ref>ciroTrust Energy Protector 400/650</A> 及 
<@ref>ciroTrust Energy Protector 400/650</A><@ref>apc700APC Smart-UPS 700</A>。其中前者特别详细。二者都包含了一个 <CODE>powerd.c</CODE> 档，
它可以在收到低电力讯号时送讯号给 <CODE>init</CODE> 以进行紧急关机，
就像是 <CODE>/etc/inittab</CODE> 档中那几行所写的一样。其馀的，
我所能告诉您的就只有请您看看 <CODE>init</CODE> 的原始码了。
<P>就我所知的，在以下所列的 UPS 软体套件中有许多也采用了新式的连线方式。
<P>
<HR>
<A HREF="UPS-HOWTO-3.html"><IMG SRC="img/next.gif" ALT="Next"></A>
<A HREF="UPS-HOWTO-1.html"><IMG SRC="img/prev.gif" ALT="Previous"></A>
<A HREF="UPS-HOWTO.html#toc2"><IMG SRC="img/toc.gif" ALT="Contents"></A>
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
