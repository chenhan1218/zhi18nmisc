<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
 <META NAME="GENERATOR" CONTENT="ZH-SGML-Tools 1.0.9">
 <TITLE>The Loopback Root Filesystem HOWTO: 启动系统</TITLE>
 <LINK HREF="Loopback-Root-FS-5.html" REL=next>
 <LINK HREF="Loopback-Root-FS-3.html" REL=previous>
 <LINK HREF="Loopback-Root-FS.html#toc4" REL=contents>
<SCRIPT src="../menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(1, 2, 6);</SCRIPT>
<A HREF="Loopback-Root-FS-5.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<A HREF="Loopback-Root-FS-3.html"><IMG SRC="../img/prev.gif" ALT="Previous"></A>
<A HREF="Loopback-Root-FS.html#toc4"><IMG SRC="../img/toc.gif" ALT="Contents"></A>
<HR>
<H2><A NAME="s4">4. 启动系统</A></H2>

<P>要用这个根目录装置启动必须将前面所做的开机软碟放於 PC 中, 并由这个软碟开机.
<P>
<P>你将会看到下列的程序
<OL>
<LI>DOS 启动</LI>
<LI>AUTOEXEC.BAT 执行</LI>
<LI>LOADLIN 执行</LI>
<LI>Linux 核心被复制到记忆体中</LI>
<LI>起始记忆体磁碟被复制到记忆体中</LI>
<LI>Linux 核心开始执行</LI>
<LI>在起始记忆体磁碟中的 <CODE>/linuxrc</CODE> 命令稿被执行</LI>
<LI>DOS 分割区被挂载, 且根目录装置与置换装置被设定</LI>
<LI>由绕回装置完成开机程序</LI>
</OL>
<P>开机完成後, 你可以取出开机软碟并使用这个 Linux 系统.
<P>
<H2><A NAME="ss4.1">4.1 可能发生的问题与解决方式</A>
</H2>

<P>开机程序可能在许多关卡上失败, 我将试著解释他们与该如何检查.
<P>
<P>DOS 的启动很容易辨别, 他应该会显示 <CODE>MS-DOS Starting ...</CODE>.
如果没有显示, 则这个软碟可能是不可开机的, 或电脑不是由这台软碟机开机.
<P>
<P>当 <CODE>AUTOEXEC.BAT</CODE> 被执行的时候, 所有被执行的指令预设会显示在萤幕上.
在此处应该只有一行, 并以 <CODE>LOADLIN</CODE> 开头.
<P>
<P>当 <CODE>LOADLIN</CODE> 执行时, 应该有二样很容易看的的事情发生.
首先是他会将核心载入记忆体中.
接著会将起始记忆体磁碟载入记忆体.
这二个都可以由 <CODE>Loading...</CODE> 讯息确认.
<P>
<P>核心将自己解压缩, 而且当核心档案损坏时, 将显示 <B>crc</B> 错误.
当核心开始执行时, 会显示一堆初始化程序与检查讯息.
初始记忆体磁碟的载入也会在此阶段显示.
<P>
<P>当 <CODE>/linuxrc</CODE> 开始执行时, 不会有可供诊断的讯息产生, 但你可以自己加入辅助讯息来检查.
在这个程序中, 如果在将绕回装置当成根目录装置时失败的话, 你将会得到 "没有根目录装置" 的讯息, 且核心会放弃执行.
<P>
<P>接下来定义在根目录装置中的正常开机程序会被启动.
你有可能得到根目录被挂载成可读写的警告, 但在 <CODE>LOADLIN</CODE> 指令中的 '<CODE>ro</CODE>' 可以解决这个问题.
当开机程序弄不清哪个是根目录装置时, 会产生一些问题, 这个问题多半来自 <CODE>/etc/fstab</CODE> 中的错误.
<P>
<P>当开机程序完成後, 剩下的问题是程式搞不清楚 DOS 分割区被挂载在何处.
这也是为何要执行一个"假"的挂载指令, 这将使你较容易存取 DOS 分割区.
<P>
<P>
<H2><A NAME="ss4.2">4.2 参考文件</A>
</H2>

<P>在我建立第一个入回根目录档案系统时, 我参考了下列文件:
<P>
<P>
<UL>
<LI>Linux 核心原始码, 特别是 <CODE>init/main.c</CODE></LI>
<LI>Linux 核心说明文件, 特别是 <CODE>Documentation/initrd.txt</CODE> 以及 <CODE>Documentation/ramdisk.txt</CODE>.</LI>
<LI><CODE>LILO</CODE> 说明文件.</LI>
<LI><CODE>LOADLIN</CODE> 说明文件.</LI>
</UL>
<P>
<P>
<HR>
<A HREF="Loopback-Root-FS-5.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<A HREF="Loopback-Root-FS-3.html"><IMG SRC="../img/prev.gif" ALT="Previous"></A>
<A HREF="Loopback-Root-FS.html#toc4"><IMG SRC="../img/toc.gif" ALT="Contents"></A>
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
