<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
 <META NAME="GENERATOR" CONTENT="ZH-SGML-Tools 1.0.9">
 <TITLE>COFFEE-HOWTO --如何用 Linux 来煮咖啡: 电路</TITLE>
 <LINK HREF="Coffee-3.html" REL=next>
 <LINK HREF="Coffee-1.html" REL=previous>
 <LINK HREF="Coffee.html#toc2" REL=contents>
<SCRIPT src="../menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(1, 2, 6);</SCRIPT>
<A HREF="Coffee-3.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<A HREF="Coffee-1.html"><IMG SRC="../img/prev.gif" ALT="Previous"></A>
<A HREF="Coffee.html#toc2"><IMG SRC="../img/toc.gif" ALT="Contents"></A>
<HR>
<H2><A NAME="s2">2. 电路</A></H2>

<P>总的图解如下:
<P>
<BLOCKQUOTE><CODE>
<PRE>
--------- 0-5V  --------- ~220V   ----------------
|  PC   |===>===|电子回路|========|     咖啡机   |
---------       ---------         ----------------
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>我们的想法是从电脑输出一个控制电压，然后通过继电器或者双向晶闸管电路驱动被电隔离的电子回路。
<P>
<P>你必须选择一个继电器电路，如果你有一个大的咖啡机（功率大于200 W ），你还可以用一个双向晶闸管电路。
<P>所有列出的电路都至少被测试过一次，不过使用者自己承担所有的后果。
如果你对电子学一点没经验，你不应尝试这些，要不然，你会有一个糟糕的结局...
<P>
<P>对 220V 电压的操作应该非常小心，而且还应用上一根合适的保险丝。
<P>
<H2><A NAME="ss2.1">2.1 从电脑提取0-5V电源</A>
</H2>

<P>下面是一个从电脑并口提取0-5V电源的例子：
<P>
<BLOCKQUOTE><CODE>
<PRE>
      公 DB-25           -----    针脚 10 - ACK（应答）
      连 接 器           |   |    针脚  9 - D7
      后 视 图           |   |                           针脚 2 - D0
                         v   v                           v   针脚 1 -滤波

       ____________________________________________________________
      /                                                            \
      \     13  12  11  10   9   8   7   6   5   4   3   2   1     /
       \                                                          /
        \     25  24  23  22  21  20  19  18  17  16  15  14     /
         \______________________________________________________/
</PRE>
</CODE></BLOCKQUOTE>
<P>
<P>针脚 1 滤波 (反逻辑)
<P>针脚 2-9 是数据总线的信号，通过一个 OUTB 命令发信给并口的门闩线路。
<P>针脚 10 是应答信号( ACK )，由你控制，所以你可以产生一个中断信号给 CPU 。
<P>针脚 18-25 被短路了，都是地线 ( GND ) 。
<P>
<P>详细地说明如下:
<BLOCKQUOTE><CODE>
<PRE>
&lt;=发送   DB25    Cent   信号          寄存
=>接收  pin     pin     定义          器位      功能注释
------  ----    ----    --------        ---     -----------------------------
=>       1       1      -滤波           C0-     设置低位脉冲 > 0.5us 发送
=>       2       2      数据线0         D0      设置最小有效数据
=>       3       3      数据线1         D1      ...
=>       4       4      数据线2         D2      ...
=>       5       5      数据线3         D3      ...
=>       6       6      数据线4         D4      ...
=>       7       7      数据线5         D5      ...
=>       8       8      数据线6         D6      ...
=>       9       9      数据线7         D7      设置最大有效数据
&lt;=      10      10      -应答           S6+ IRQ 接受应答后，低位脉冲 5us
&lt;=      11      11      +忙             S7-     忙/出错/断线时高位
&lt;=      12      12      +无纸           S5+     无纸时高位
&lt;=      13      13      +已选择         S4+     已选择打印机时高位
=>      14      14      -自动注入       C1-     低位时自动注入一行
&lt;=      15      32      -错误           S3+     错误/断线/无纸时低位
=>      16      31      -初始化         C2+     设置低位脉冲 > 50us 初始化
=>      17      36      -选择           C3-     设置低位选择打印机
==      18-25   19-30,  地线
</PRE>
</CODE></BLOCKQUOTE>
<P>
<H2><A NAME="ss2.2">2.2 用继电器电路控制</A>
</H2>

<P>最简单的电路如下:
<BLOCKQUOTE><CODE>
<PRE>

                             Vcc
                              |
                              +------+
                              |    __|__
                           继电器   /^\  二极管 1N4002
                             线圈  /---\
                              |      |
                              +------+
                              |
                           | / 
                 4.7K    B |/  C
    并口数据脚>-\/\/\/\/---|        NPN 三极管: BC547A or 2N2222A
                           |\  E
                           | V
                             |
    并口地线  >--------------+
                             |
                           接地
</PRE>
</CODE></BLOCKQUOTE>

Vcc 的选择应同所选继电器型号的电压一样( 通常是 5V 或者是 12V )。很明显，继电器的规格应该由咖啡机的功率决定。
<P>酒保们通常倾向于在三极管之后再放置继电器，然后用发射极( E 脚 ) 代替集电极( C 脚 ) 连接继电器，这是一个错误的经历，因为三极管被错误的偏置了，结果是得到了一杯糟糕的咖啡　:-)。二极管　1N4002　对保护三极管避免被从继电器流出的电流烧坏很有帮助，如果你不用它，三极管很可能会变黑，发臭，且被烧坏。
<P>
<H2><A NAME="ss2.3">2.3 用双向晶闸管电路控制 #1</A>
</H2>

<P>如果你只想要一个简单的电路，你可以选用摩托罗拉的 MOC301[012] 双向晶闸管驱动器，它跟通常用的 SC141D 双向晶闸管一起搭配使用。这种电路有个优点就是它不需要额外的电源供给。
<P>以下是为非感应负荷设计的电路:
<BLOCKQUOTE><CODE>
<PRE>

        270     1 +-------+ 6    180
  +5v -VAVAVA-----+       +----VAVAVA-----+-------------- Line Hot
                2 |  MOC  |               |
  TTL in ---------+ 3012  +nc            VA  SC141D
                  |       | 4           / |
                nc+       +------------/  |
                  +-------+               +----\/\/\/---- Line Neutral
                                                LOAD
</PRE>
</CODE></BLOCKQUOTE>
<P>如果你正在使用 220V 电压，MOC3021 可能更好。
感性负载应该和旁路电容相连，查阅 <EM>摩托罗拉应用手册 AN-780</EM>.
咖啡机一般是非感性负载（就象马达一样），但谁知道你的会是什么样的.....
<P>
<H2><A NAME="ss2.4">2.4 用双向晶闸管电路控制 #2</A>
</H2>

<P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
+5VDC
|    180                      180            2.2k
+---/\/\/\----+-----+   +----/\/\/-+--/\/\/\---+-------> 120V
              |    1|   |6         |           |         Hot
              |    +=====+         |           | MT1
              |    | MC  | 双向晶闸|          +-+
              |    | 3032| 管驱动器|        G | | 双向晶闸管
              |    +=====+         |         /| |
              \    2|   |4         |        / +-+
       2N3904  |----+   |          |        |  | MT2
              /     |   +--------- | -------+  |
             V      \              |        |  |
             |      /              |        \  |
             |      \ 43    .01u  ---   10k /  |
             |      /       500V  ---       \  |
             |      |              |        /  |
             +------+              |        |  |            Neutral
             |                     +--------+--+---o    o--> 120V
             /                                      load
 >-/\/\--|  2N3904
             \
              V
              |
             ---
            ///
你应该以 220V 的标准调整电阻值。
</PRE>
</CODE></BLOCKQUOTE>
<P>电路详解:
<P>MC3032 是光隔离双向晶闸管驱动器。
180 欧姆的电阻设定了光隔离器里面的发光二极管的电流。如果需要，你可以调整这个电阻从而得到一个合理的电流。（比如 15 mA）。
<P>注意你不能在没有负载的情况下测试电路。除非连上了交流电源，双向晶闸管不会切换，所以你也不能在有交流电源和负载的情况下测试它的简单切换，注意这个 .01u 的电容要达到 500V 的耐压。
<P>
<HR>
<A HREF="Coffee-3.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<A HREF="Coffee-1.html"><IMG SRC="../img/prev.gif" ALT="Previous"></A>
<A HREF="Coffee.html#toc2"><IMG SRC="../img/toc.gif" ALT="Contents"></A>
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
