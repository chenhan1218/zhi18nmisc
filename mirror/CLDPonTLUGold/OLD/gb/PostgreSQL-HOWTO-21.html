<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312">
 <META NAME="GENERATOR" CONTENT="ZH-SGML-Tools 1.0.9">
 <TITLE> Linux 的 Database-SQL-RDBMS HOWTO 文件 (PostgreSQL 物件关联资料库系统): PHP Hypertext PreProcessor□PostgreSQL 的伺服器端 html 嵌入命令稿语言</TITLE>
 <LINK HREF="PostgreSQL-HOWTO-22.html" REL=next>
 <LINK HREF="PostgreSQL-HOWTO-20.html" REL=previous>
 <LINK HREF="PostgreSQL-HOWTO.html#toc21" REL=contents>
<SCRIPT src="menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(0, 2, 5);</SCRIPT>
<A HREF="PostgreSQL-HOWTO-22.html"><IMG SRC="img/next.gif" ALT="Next"></A>
<A HREF="PostgreSQL-HOWTO-20.html"><IMG SRC="img/prev.gif" ALT="Previous"></A>
<A HREF="PostgreSQL-HOWTO.html#toc21"><IMG SRC="img/toc.gif" ALT="Contents"></A>
<HR>
<H2><A NAME="PHP"></A> <A NAME="s21">21. PHP Hypertext PreProcessor□PostgreSQL 的伺服器端 html 嵌入命令稿语言</A></H2>

<P>万维网介面工具位於∶
<UL>
<LI> 
<A HREF="http://www.php.net">http://www.php.net</A></LI>
<LI> 
<A HREF="http://www.vex.net/php">http://www.vex.net/php</A></LI>
</UL>

PHP 也有一个名为 Zend 的编译器，可大幅改善表现。首先你在开发、测试和除错时使用 
PHP 命令稿语言。当准备好正式使用时使用 Zend 编译器产生可迅速执行的执行档。
<P>前身为 Professional Home Pages（PHP）而现在称为 PHP Hypertext Pre-Processor
<UL>
<LI> 很多国定都有映射站台，名为 www.COUNTRYCODE.php.net</LI>
<LI> 
<A HREF="http://www.fe.de.php.net">http://www.fe.de.php.net</A></LI>
<LI> 
<A HREF="http://www.sk.php.net">http://www.sk.php.net</A></LI>
<LI> 
<A HREF="http://php.iquest.net/">http://php.iquest.net/</A></LI>
<LI> 问题可电邮到∶
<A HREF="mailto:rasmus@lerdorf.on.ca">rasmus@lerdorf.on.ca</A></LI>
</UL>

PHP 是一个伺服器端 html 嵌入命令稿语言。它让你在你的 .HTML 
档中加入简单的命令稿，像 JavaScript 般。不过，和 JavaScript 不同，PHP 
独立於浏览器。JavaScript 是一种客户端的 html 嵌入命令稿语言，而 PHP 
是伺服器端语言。PHP 的概念和 Netscape 的 LiveWire Pro 
产品相似。如果你喜欢快速更新又包括源程式码的自由软件，你大概会喜欢 PHP 3。
<P>
<UL>
<LI> 支援 PostgreSQL 的程式码由 Adam Sussman 写成
<A HREF="mailto: asussman@vidya.com">asussman@vidya.com</A></LI>
</UL>
<P>
<H2><A NAME="ss21.1">21.1 主要特色</A>
</H2>

<P>
<UL>
<LI>标准的 CGI，FastCGI 和 Apache 模组支援□
作为一个标准的 CGI 程式，PHP 可在执行任何 Unix 互联网伺服器的任何 Unix 
电脑上安装。加上对新 FastCGI 标准的支援，PHP 可从中得到速度上的改善。作为一个 
Apache 模组， PHP 变成 CGI 程式外一个强劲及<B>快如闪电</B>的选择。
</LI>
<LI> 存取记录 (Access Logging)□
籍著 PHP 的存取纪录功能，用者可自行维护命中数字 (hit counting) 
及作出纪录。它完全不利用系统中央的纪录档，而且即时监察存取过程。Log Viewer 
Script 提供了个别用者拥有的页面的存取摘要。此外，
本套件可被设定为在每页产生一个显示存取资料的注脚。本页的结尾就有一个例子。
</LI>
<LI> 存取控制 (Access Control)□
一个以万维网为基础的内建设定画面处理取控制设定。
用者可以为某人拥有的所有或个别网页建立规则，限制谁人能及他能怎样阅读有关网页。
根据用者的网域、浏览器、电邮地址甚至来源文件 (referring 
document)，网页可以密码保护、完全看不到、禁止纪录 (logging disabled) 
和做其他事。
</LI>
<LI> PostgreSQL 支援□
Postgres 是一个先进的自由 RDBMS。利用 PHP，用者可直接在 .HTML 档中嵌入 
PostgreSQL 的「SQL 查询」。
</LI>
<LI> RFC-1867 档案上传支援□
档案上传是 Netscape 2.0 的新功能。它让用者把档案上传到万维网伺服器。
使得这事行可的原因，是实际的 Mime 解码由 PHP 提供，它可提供额外的框架，
在收到上传的档案後做些有用的事。
</LI>
<LI> HTTP 为基础的认证控制□
PHP 可用来在 Apache 万维网伺服器中建立自定的以 HTTP 为基础的认证机制。
</LI>
<LI> 变数、列阵、相联列阵 (Associative Arrays)□
PHP 支援变数形态、列阵、甚至如 Perl 般的相联列阵。它们可籍 GET 或 POST 
方法在网页间传递。
</LI>
<LI> 条件式、While 回圈□
PHP 支援一种类似 C 的全功能命令稿语言。你可使用 if/then/elseif/else/endif 
条件式、while 回圈和 switch/case 叙述来指引你的 html 页的显示的逻辑流向。
</LI>
<LI> 延伸正规表达式□
正规表达式常被用於样式匹配、样式替换 (pattern substitutions) 
和一般的字串处理。PHP 支援所有常用的正规表达式运作。
</LI>
<LI> 原始 HTTP 标头控制□
要进行高阶网站设计，使网页视情形传送自定 HTTP 标头的能力是必须的。
一个惯常用法是传送一个 Location: URL 标头来把客户端传送到其他 
URL。它也可用於关掉快取或处理网页页首上的“last update”标头。
</LI>
<LI> 即时 GIF 图像产生□
PHP 支援 Thomas Boutell 的 GD 图像函式库，使它可即时产生 GIF 图像。
</LI>
<LI> ISP“安全模式”支援□
PHP 支援一个独有的“安全模式”(Safe Mode)，使得在同一伺服器上有多个用户使用 
PHP 命令稿也没安全问题。
</LI>
<LI> 新版本的 PHP 加入了很多新功能，请参阅主网页 
<A HREF="http://www.php.net">http://www.php.net</A>
</LI>
<LI> 它是自由的！
最後一个必要的特性。这套件是完全自由的。它以 GNU/GPL 
授权，让你可为任何目的使用这软件，包括商业用途。欲知详情，请参看 GNU General 
Public License 文件。</LI>
</UL>
<H2><A NAME="ss21.2">21.2 PHP□简史</A>
</H2>

<P>初出现时，PHP 是一个以 Perl 写成小巧简单的 cgi 包装器 
(wrapper)。这套件最先名为 Personal Home Page Tools，後来变为 Personal Home 
Page Construction Kit。
<P>另有一工具是写来简化在网页中嵌入 SQL 查询的工作。它基本上是另一个 CGI 
包装器，能分析 (parsed) SQL 查询及简化建立根据这些查询的表格和列表的工作。
这工具名为 FI (Form Interpreter)。
<P>PHP/FI 2.0 版完全重写这两套件，将之合而为一。它进化至可把简单电脑语言嵌入 
HTML 档中。它籍著把所简单的命令稿直接嵌入 HTML 档中，消除大量小型 Perl cgi 
程式的需要。这样会加快你的网页，因为 fork 多次 Perl 的困扰已经消除。
它也简化了管理大型网站的工作，因为你可把网页的所有部分放在一个 html 
档中。加上多种资料库的支援，可使用资料库的网页的开发变得简单。
很多人觉得嵌入查询比分别建立 HTML 和 CGI 档简单得多。
<P>PHP/FI 已改名为 PHP。
<H2><A NAME="ss21.3">21.3 那麽，我能用 PHP 做什麽？</A>
</H2>

<P>如果你使用 PHP，你首先会注意到它在页尾加上这网页曾被浏览过多少次的资料
（如果你在在编译时选取了 access logging）。这只是 PHP 所做的一小部分。
它的另一个重要角色是作为一个表格直译 cgi 程式 (form interpreter 
cgi)，这也就是首名中 FI 的意思。例如，如果你在一个网页中建立了一个表格，
你需要一个程式来处理表格上的资料。即使你只想把资料传送到另一网页，你也需要 
cgi 程式的帮助。PHP 使得取得和处理表格的资料极为容易。
<H2><A NAME="ss21.4">21.4 一个简单的例子</A>
</H2>

<P>假设你有一张表格∶
<BLOCKQUOTE><CODE>
<PRE>
&lt;FORM ACTION="/cgi-bin/php.cgi/~userid/display.html" METHOD=POST>
&lt;INPUT TYPE="text" name="name">
&lt;INPUT TYPE="text" name="age">
&lt;INPUT TYPE="submit">
&lt;FORM>
</PRE>
</CODE></BLOCKQUOTE>

你的 display.html 便可包括类似的东西∶
<BLOCKQUOTE><CODE>
<PRE>
&lt; ?echo "Hi $ name, you are $ age years old!&lt;p>" &gt;
</PRE>
</CODE></BLOCKQUOTE>

就是这样简单！PHP 自动为每个表格输入栏位产生一个变数。之後你便可在 ACTION URL 
档中使用这些变数。
<P>在你找出如何使用变数之後的步骤就是在网页中试用一些逻辑流程标签。例如，
如果你想根据用者输入显示不同讯息，你可使用 if/else 逻辑。在上面的例子，
我们可改变 display.html，使得不同东西会根据用户输入显示出来∶
<BLOCKQUOTE><CODE>
<PRE>
&lt;?
    if($age>50);
        echo "Hi $name, you are ancient!&lt;p>";
    elseif($age>30);
        echo "Hi $name, you are very old!&lt;p>";
    else;
        echo "Hi $name.";
    endif;
>
</PRE>
</CODE></BLOCKQUOTE>

PHP 提供一种非常强劲的命令稿语言，能做到的事比以上简单的例子多很多。欲知详情，
请参阅有关 PHP Script Language 的章节。
<P>你也可使用 PHP 来设定有什麽人能看到你的网页。这可使用一个内建的设定画面做到。
例如，籍著它你可指定只有某些网域的人可看到你的网页，
或建立一些规则来用密码保护某些网页。欲知详情，请参阅有关 Access Control 的章节。
<P>PHP 也有能力接收任何依照 RFC-1867 规定的浏览器上传的档案。
这特色使用者能上传文字或二元档。籍著 PHP 的存取控制和逻辑功能，
你可全面控制淮许谁上传及上传後做什麽。欲知详情，请参阅有关 File Upload 的章节。
<P>PHP 支援 PostgreSQL 资料库套件。它支援在 .HTML 档中嵌入 SQL 查询。
<P>PHP 也支援 mysql 资料库套件。它支援在 .HTML 档中嵌入 SQL 查询。
<H2><A NAME="ss21.5">21.5 CGI 改向 (Redirection)</A>
</H2>

<P>
<H3>Apache 1.0.x 摘要</H3>

<P>使用 Apache 伺服器的 cgi 改向模组是执行 PHP 的一个好方法。
请注意你无须担心改向模组，如果你使用 PHP 的 Apache 模组版本 (Apache module 
version)。有两个这类改向模组。一个是 Dave Andersen 开发的∶
<UL>
<LI>       
<A HREF="mailto:angio@aros.net">angio@aros.net</A></LI>
</UL>

它可在以下地方找到
<UL>
<LI>     
<A HREF="ftp://ftp.aros.net/pub/util/apache/mod_cgi_redirect.c">ftp://ftp.aros.net/pub/util/apache/mod_cgi_redirect.c</A></LI>
</UL>

另一个已包括在 Apache 中，名为 mod_actions.c。这些模组极为相似，
只是在用法上有少许差别。两个都测试过，能和 PHP 顺利合作。
<P>查看 Apache 的文件关於如何加入一个模组。一般来说，你把模组名称加到一个名为
Configuration 的档案中。如果你使用 mod_actions 模组，你要加的一句是∶
<P>Module action_module mod_actions.o
<P>如果你使用 mod_cgi_redirect 模组，加上以下一句∶
<P>Module cgi_redirect_module mod_cgi_redirect.o
<P>重新编译你的 httpd 及安装它。要设定 cgi 改向你需要在你的 mime.types 
档中建立新的 mime 类型，或在你的 srm.conf 档中使用 AddType 指令来加上 mime 
类型。所加上的 mime 类型应类似∶
<BLOCKQUOTE><CODE>
<PRE>
     application/x-httpd-php phtml
</PRE>
</CODE></BLOCKQUOTE>

如果你使用 mod_actions.c 模组，你需在 srm.conf 档中加上以下一行∶
<BLOCKQUOTE><CODE>
<PRE>
     Action application/x-httpd-php /cgi-bin/php.cgi
</PRE>
</CODE></BLOCKQUOTE>

如果你使用 mod_cgi_redirect.c 模组，你需在 srm.conf 档中加上以下一行∶
<BLOCKQUOTE><CODE>
<PRE>
     CgiRedirect application/x-httpd-php /cgi-bin/php.cgi
</PRE>
</CODE></BLOCKQUOTE>

不要同时使用 mod_actions.c 和 mod_cgi_redirect.c。
<P>安装及正确设定了这些 cgi 改向模组後，你只需把延伸档名定为 .phtml，
便可以指定这档案由 PHP 分析。此外，如果你在 srm.conf 档的 DirectoryIndex 
设定行加上 index.phtml，最上层的网页便会自动由 php 分析，如果你的 index 
档名为 index.phtml。
<H3>Netscape HTTPD</H3>

<P>你可籍 Netscape Server CGI Redirection 
模组来指定自动把对某些延伸档名的档案的要求改向给 PHP。这模组可在 PHP 网页的 
File Archieves 中找到。套件中的 README 明确地解释了如何设定它来用於 PHP。
<H3>NCSA HTTPD</H3>

<P>目前，NCSA 并不支援模组，所以，要使用 cgi 改向的话，你要修改伺服器的原始码。
一个对 NCSA 1.5 做这工作的嵌补在在 PHP 档案存库中找到。
<H2><A NAME="ss21.6">21.6 在指令行执行 PHP</A>
</H2>

<P>如果你建立了 CGI 版本的 PHP，你只需在指令行输入 php.cgi filename，而filename 
是你想分析的档案。你可建立独立的 PHP 命令稿，只需把命令稿 (script) 
的第一行写为类似∶
<BLOCKQUOTE><CODE>
<PRE>
    #!/usr/local/bin/php.cgi -q
</PRE>
</CODE></BLOCKQUOTE>

“-q”阻止印出 HTTP 标头。喜欢的话，你可不用这选择。
<H2><A NAME="ss21.7">21.7 PHPGem 套件</A>
</H2>

<P>PHPGem 是一个 PHP 命令稿，用以加速编写使用表格的 PHP 命令稿。它可用於不同的 
SQL 伺服器，如 PostgreSQL、MySQL、mSQL、ODBC 和 Adabas。
你输入表格栏位的描述和参数（栏位名称、栏位的 on/off searching (?) 等等），
PHPGem 输出另一个使用那些表格的 PHP 命令稿（检视/加/修改/删除/重覆内容和搜索）。
PHPGem 可使用多层巢状表格 (multi-level nested tables, ??)。PHPGem 
容许你指定每个表格每个栏位每人□存取控制。PHPGem 也支援影像。
<P>PHPGem 在 
<A HREF="http://sptl.org/phpgem">http://sptl.org/phpgem</A> 找到。
<HR>
<A HREF="PostgreSQL-HOWTO-22.html"><IMG SRC="img/next.gif" ALT="Next"></A>
<A HREF="PostgreSQL-HOWTO-20.html"><IMG SRC="img/prev.gif" ALT="Previous"></A>
<A HREF="PostgreSQL-HOWTO.html#toc21"><IMG SRC="img/toc.gif" ALT="Contents"></A>
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
