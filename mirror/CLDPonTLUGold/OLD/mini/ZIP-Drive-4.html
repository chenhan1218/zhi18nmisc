<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=big5">
 <META NAME="GENERATOR" CONTENT="ZH-SGML-Tools 1.0.9">
 <TITLE>Zip Drive Mini-HOWTO: ZIP 磁碟機</TITLE>
 <LINK HREF="ZIP-Drive-5.html" REL=next>
 <LINK HREF="ZIP-Drive-3.html" REL=previous>
 <LINK HREF="ZIP-Drive.html#toc4" REL=contents>
<SCRIPT src="../menu.js"> function BeginPage() {} function EndPage() {} </SCRIPT> </HEAD> <BODY bgcolor=#EEEEFF MARGINHEIGHT=0 MARGINWIDTH=0> <SCRIPT>BeginPage(1, 2, 6);</SCRIPT>
<A HREF="ZIP-Drive-5.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<A HREF="ZIP-Drive-3.html"><IMG SRC="../img/prev.gif" ALT="Previous"></A>
<A HREF="ZIP-Drive.html#toc4"><IMG SRC="../img/toc.gif" ALT="Contents"></A>
<HR>
<H2><A NAME="s4">4. ZIP 磁碟機</A></H2>

<P>Iomega ZIP 100 磁碟機最少有五種或六種不同版本。
Iomega 網站上有關這些磁碟機的部分在 
<A HREF="http://www.iomega.com/zip/">http://www.iomega.com/zip/</A>。
所有的機種都能使用容量為 100 MB 的特殊 3.5" 磁片匣。
這種磁片實際上有 96 個磁柱（Cylinder），每個磁柱有 2048 個磁區，每個磁區有 512 位元組。這種磁片的實際容量通常為 96 MB。
<P>外接式的機種有：
<UL>
<LI> 並列埠</LI>
<LI> SCSI</LI>
<LI> Plus</LI>
</UL>
<P>內接式的機種有：
<UL>
<LI> SCSI</LI>
<LI> IDE</LI>
<LI> ATAPI</LI>
</UL>
<P>內接式的機種能夠裝在電腦機殼的 3.5 或 5.25 吋磁碟機槽。
外接式的機種則是裝在一個藍色小塑膠機殼中<CODE><B>[譯者註]</B></CODE>，並由外部的電源供應器供應電源。
<P><B><CODE>[譯者註] 早期曾有一段時間，EPSON 有代理外接式並列埠 ZIP 磁碟機，EPSON 所代理的機器的機殼顏色是白色的。</CODE></B>
<P>不管是哪一種機型，每部 ZIP 磁碟機的前面板都會有一個按鈕。那是退片鈕。
當 ZIP 磁碟機被使用時，Linux 會鎖住磁片，然而若在此時按下了退片鈕，ZIP 磁碟機會『記起來』退片要求，並且在系統解除鎖定磁片後，立刻將磁片退出來。
<P>
<H2><A NAME="ss4.1">4.1 並列埠版本的 ZIP 100 磁碟機</A>
</H2>

<P>這個版本的 ZIP 磁碟機相關資訊可以在這裡找到：
<A HREF="http://www.iomega.com/zip/products/parallel_port.html">http://www.iomega.com/zip/products/parallel_port.html</A><P>Linux 的 ZIP 驅動程式有幾個不同的版本。在 2.0.x 的核心附的是 0.26 版的 ppa.c 驅動程式。
如果你的核心版本低於 2.0.35，那麼你有一個<B>老舊版本的</B>驅動程式。
到
<A HREF="http://www.torque.net/~campbell/">David Campbell's page</A>
來找找比較新的版本。在寫這篇 mini-Howto 時，最新的版本是 1.42 版<CODE><B>[譯者註]</B></CODE>。
<P><B><CODE>[譯者註] 在我翻譯這篇 mini-Howto 時（May 1999），最新的版本仍是 1.42 版。</CODE></B>
<P>1.4x 版驅動程式的自動硬體組態偵測功能實在太棒了。
你不需要告訴驅動程式你的並列埠的基底記憶體位置，驅動程式會自動偵測並列埠的標準基底位址，如果偵測到 ZIP 磁碟機的話，還會自動連接磁碟機。
<P>最常遇到的錯誤是在載入 ppa 驅動程式前，先載入了 lp 印表機模組。ppa 驅動程式必須在 lp 模組之前載入。
ppa 驅動程式之所以必須先載入的原因是因為 lp 模組會佔用 ZIP 磁碟機所用的輸出入埠。
<P>另外也請確定所有電纜都有穩固的連接妥當。
<P>如果你一切都做對了 :) 你會在開機時看到類似這樣的訊息：
<P>
<PRE>
  VFS: Mounted root (ext2 filesystem) readonly.
  Adding Swap: 102528k swap-space (priority -1)
  ppa: Version 1.42
  ppa: Probing port 03bc
  ppa: Probing port 0378
  ppa:     SPP port present
  ppa:     EPP 1.9 with hardware direction protocol
  ppa: Found device at ID 6, Attempting to use EPP 32 bit
  ppa: Communication established with ID 6 using EPP 32 bit
  ppa: Probing port 0278
  ppa:     SPP port present
  scsi0 : Iomega parport ZIP drive
  scsi : 1 host.
    Vendor: IOMEGA    Model: ZIP 100           Rev: D.09
    Type:   Direct-Access                      ANSI SCSI revision: 02
  Detected scsi removable disk sda at scsi0, channel 0, id 6, lun 0
  SCSI device sda: hdwr sector= 512 bytes. Sectors= 196608 [96 MB] [0.1 GB]
  sda: Write Protect is off
    sda: sda4
  lp2 at 0x0278, (polling)
  
</PRE>
<P>你能夠用 dmesg | more 指令來查看開機訊息。
你也可以用 dmesg > dmesg.txt 指令將開記訊息存到檔案中。
當你試著找出安裝上的錯誤時，這個檔常常十分有用。
<P>
<P>此外，也請看看 "
<A HREF="ZIP-Drive-9.html#sec-more-info">取得更多最新資訊</A>" 這個章節。
<P>
<H2><A NAME="ss4.2">4.2 SCSI 外接式版本</A>
</H2>

<P>Iomega 網站上有關這種磁碟機的部分在 
<A HREF="http://www.iomega.com/zip/products/scsi.html">http://www.iomega.com/zip/products/scsi.html</A>。
<P>SCSI 介面的外接式 ZIP 磁碟機有兩個 DB25F 接頭及兩個設定開關。
其中一個開關是用來設定磁碟機的標的位址<CODE><B>[譯者註]</B></CODE>。能夠選擇的值限制在 5 或 6。
另一個開關是當 ZIP 磁碟機是 SCSI 電纜上串接的最後一個裝置時，用來開啟內部終端電阻用的。
25 針的 SCSI 接頭是採用類似麥金塔（Macintosh）電腦所用的配線方式。
購買磁碟機時，會隨貨附一條麥金塔的 SCSI 電纜線，然而，若你的 SCSI 配接卡是用 Centronics 接頭或者高密度接頭的話，標準 SCSI 電纜線以及轉換接頭應該很容易取得。
<P><B><CODE>[譯者註] 原文是 target address，由語意判斷，應該是指 SCSI ID。</CODE></B>
<P>我沒看過內接式的 SCSI ZIP 磁碟機，但我猜應該也有一個 50 針 DIP SCSI 接頭以及兩個一樣的設定開關。
<P>請確定你所設定的標的位址沒有和在同一個匯流排上的其他 SCSI 裝置相衝突。
也請確定在 SCSI 電纜線上串接的最後一個裝置有啟動內部終端電阻，或者裝上一個外部終端電阻。
<P>如果你有內接式的 SCSI 硬碟或光碟機，並且你將你的 ZIP 磁碟機接在同一個 SCSI 配接卡上，你應該檢查看看是否有必須要移除的終端電阻。
只有 SCSI 匯流排上最末兩端必須接上終端電阻。
如果你的 SCSI 匯流排上同時有內接式以及外接式的 SCSI 裝置，那麼最後的一個內接以及外接裝置上必須接上終端電阻，但是 SCSI 配接卡本身不需要終端電阻。
<P>請確定所有的電纜線都有緊緊地接好。
<P>核心的組態設定和設定內接式版本時一樣。請參考下面 SCSI 內接式版本章節中的設定範例。
<P>
<H3>ZIP ZOOM 主配接卡</H3>

<P>ZIP Zoom 是 Iomega 賣的 SCSI 主配接卡。
這塊卡的設計實際上是基於 <B>Adaptec AHA1520</B> 系列配接卡。
這塊卡上有一個與隨 ZIP 磁碟機附贈的電纜線相容的，Macintosh 用的 DB25F 外接接頭。
<P>支援這塊配接卡的 Linux 驅動程式是 <B>aha152x</B>。
<P>
<H2><A NAME="ss4.3">4.3 SCSI 內接式版本</A>
</H2>

<P>  
<P>硬體的安裝請見『安裝與參考指引』。請注意所使用的 SCSI ID，IRQ 及 I/O 埠位址（稍後你將會需要這些資訊）。
<P><B>請小心</B> ZIP Zoom 這塊卡在硬體線路上直接設定了使用 SCSI ID 7。
在接下來的命令列中所提到的 SCSI ID 是指 SCSI 卡的 ID ，而不是磁碟機的。
卡和磁碟機必須使用不同的 SCSI ID。例如，如果卡的 ID 是 7，則磁碟機使用 5 或其他的 ID。
<P>在開啟了支援 『SCSI』，『SCSI disk』及『AHA152X/2825』等的組態設定後，重新編譯核心，並請安裝新的核心 :-(
<P>請決定適合你的系統的核心啟動參數：
<P><CODE> aha152x=[I/O Port][,IRQ][,SCSI ID][,RECONNECT][,PARITY] </CODE>
<P>例如：
<P><CODE>  aha152x=0x140,10,7,1 </CODE>
<P>如果你是使用 LILO，將核心啟動參數加到 lilo.conf 的 append 命令中。
<P>（例如將 append = "aha152x=0x140,10,7,1" 加到 lilo.conf 中）
<P>如果你是用 LOADLIN，那麼將你的核心啟動參數加到你用來啟動 loadin 的命令中。
<P>
<PRE>
（例如 loadlin c:\vmlinuz root=/dev/hda3 aha152x=0x140,10,5,1 ro）
</PRE>
<P>
<P>
<H2><A NAME="ss4.4">4.4 ZIP Plus - IMM 驅動程式</A>
</H2>

<P>這是一種<B>比較新</B>的外接式 ZIP 磁碟機。
<B>Zip Plus</B> 不是用 ppa 驅動程式, 而是使用 <B>imm</B> 驅動程式。
<A HREF="mailto:Philippe_Andersson@ste.scitex.com">Philippe Andersson</A>
提供了這段有關 ZIP Plus 的 imm 驅動程式的說明。謝謝 Philippe。
<P>首先，重建一個包含下列組態的核心：
<P>
<UL>
<LI>modules support</LI>
<LI>SCSI support</LI>
<LI>SCSI Disk support</LI>
<LI>lp 建成模組 (如果你需要的話)</LI>
</UL>
<P>你應該有注意到我們並沒有選擇任何低階的 SCSI 驅動程式。這沒關係 -- 我們將在稍後另外建立它。
<P>接下來，你要到 Dave Campbell 的網站取得驅動程式的原始程式碼 
(
<A HREF="http://www.torque.net/~campbell/imm.tar.gz">http://www.torque.net/~campbell/imm.tar.gz</A>)。0.18 版是在寫這份文件時（Aug. '98）的最新版本<CODE><B>[譯者註]</B></CODE>。
將檔案解壓縮到某目錄下（例如解到 <CODE>/usr/src</CODE> 下面）。接下來執行 <CODE>make</CODE>。
你就會得到 imm 驅動程式模組（<CODE>imm.o</CODE>）。將該模組複製到 
<PRE>
/lib/modules/$(uname -r)/scsi
</PRE>
 下。
<P><B><CODE>[譯者註] 在我翻譯這篇 mini-Howto 時(Jun. 1999)，最新的版本仍是 0.18 版。</CODE></B>
<P>如果你已經載入 lp 模組（可以使用 <B>lsmod</B>(1) 命令檢查），先卸除 lp 模組（<CODE>rmmod lp</CODE>），然後載入 <CODE>imm.o</CODE> 模組（<CODE>insmod imm</CODE>）。
到這裡，你已經完成了基本的設定。
<P>如果你在載入 imm 模組時， ZIP 磁碟機並沒有連接好或者沒有打開電源，你會看到 "init_module: Device or resource busy" 的錯誤訊息，而無法載入模組。（附帶一提，當你要連接 ZIP 磁碟機到電腦主機時，似乎不需要將電腦關機 -- 只要確定 imm 模組沒有載入，而且磁碟機的電源是關的，接著只要將電纜線插好，打開電源，並載入模組就可以了。）
<P>如果 ZIP 磁碟機已經接好而且也打開電源了，但是沒有插磁片在裡面，那麼 imm 模組還是會載入，但是你會看到無法讀取磁碟分割表的錯誤訊息。
這沒關係，因為當你在磁碟機內插入磁片，系統會自動讀取分割表。
<P>若你在載入模組時，ZIP 磁碟機內有插磁片，那你會看到該磁片的分割區列表以及寫入保護狀態等等的完整資訊。
下面是一個載入模組時所看到的磁片資訊的例子：
<P>
<PRE>
vger:~# insmod imm
imm: Version 0.18
imm: Probing port 03bc
imm: Probing port 0378
imm:     SPP port present
imm:     ECP with a 16 byte FIFO present
imm:     PS/2 bidirectional port present
imm:     Passed Intel bug check.
imm: Probing port 0278
scsi0 : Iomega ZIP Plus drive
scsi : 1 host.
  Vendor: IOMEGA    Model: ZIP 100 PLUS      Rev: J.66
  Type:   Direct-Access                      ANSI SCSI revision: 02
Detected scsi removable disk sda at scsi0, channel 0, id 6, lun 0
SCSI device sda: hdwr sector= 512 bytes. Sectors= 196608 [96 MB] [0.1 GB]
sda: Write Protect is off
 sda: sda1
vger:~#
</PRE>
<P>最後值得一提的是，當磁片被掛載以後，這版的驅動程式會將磁片鎖住。
如果在這時按下退片鈕，磁片並不會退出來，但是磁碟機會『記得』你的退片要求，並在你卸載（umount）磁片後立刻退片。
<P>
<P>
<H2><A NAME="ss4.5">4.5 ATAPI 版本</A>
</H2>

<P>有關這種機型的資訊可以在這裡找到：
<A HREF="http://www.iomega.com/zip/products/insider.html">http://www.iomega.com/zip/products/insider.html</A><P>之前有一小段時間還有一種 IDE 版本的磁碟機。不過我想現在絕大部分都已經被 ATAPI 版本的機器所取代。
<P>Donald Stidwell 提供我下面這些有關 ATAPI 版本的說明。謝謝 Don。
<P>我有一台 ATAPI ZIP 磁碟機，而且在 2.0.32 及 2.0.33 版的核心下都能正常運作。
我在 RH 5.0 及 OpenLinux 1.2 （我現在在使用的發行版本）下都測試過<CODE><B>[譯者註]</B></CODE>。
我所需要做的只是開啟 <B>ATAPI floppy support</B> 的核心組態設定。OpenLinux 的核心並沒有內定開啟這個功能。
<P><B><CODE>[譯者註] 我本身在 Slackware 3.3/3.6 以及 RedHat 5.2 下都能正常使用 ATAPI ZIP，測試過的核心版本有 2.0.35, 2.0.36, 2.2.1, 2.2.2 等。</CODE></B>
<P>不需要其他額外的驅動程式。ZIP 磁片會以延伸分割區(Extended Partition）的形式掛載在第 4 個分割區。
例如，我的狀況是掛載 HDB4。我以 noauto 的掛載選項將 ZIP 磁片掛載於 /mnt/zip，但是我想用自動掛載應該也不會有問題。
我想唯一可能的問題是退片。我總是在要退片前，先卸載磁片。
<P>在 1998 年五月號的 Linux Gazette 中，有對於在 Linux 下安裝 ATAPI ZIP 的更詳細介紹。
請參考 2 cent tip 的部分。
<P>
<A HREF="http://www.linuxgazette.com/issue28/lg_tips28.html#atapi">http://www.linuxgazette.com/issue28/lg_tips28.html#atapi</A><P>
<P>
<H2><A NAME="ss4.6">4.6 IDE 版本</A>
</H2>

<P>我沒用過 IDE 版本的 ZIP。Eric Backus 提供下面這些說明。謝謝 Eric。
<P>我有一台 IDE ZIP 磁碟機，是在一年前隨著我的 Gateway 2000 電腦一起買來的。
我想這種機型絕大部分都是在 ATAPI 版本的 ZIP 發行前，由這類的大型 OEM 公司隨貨賣出的。
<P>好消息是：要支援這種磁碟機，不需要額外的核心模組或者核心組態變更。
這種機型對核心而言，就跟 IDE 硬碟一樣。
我能在 2.0.31 及 2.0.32 版的核心上直接使用。
<P>而壞消息是：因為不是使用 ATAPI 協定，所以你無法啟動使用 SCSI 轉 ATAPI 的核心組態，
也就是說，你不能用 mtools 來開啟磁片的防寫功能以及退片<CODE><B>[譯者註]</B></CODE>。
<P><B><CODE>[譯者註] 請參考 mzip(1) 指令以及 mtools 的 man page 說明。</CODE></B>
<P>
<H2><A NAME="ss4.7">4.7 USB 版本</A>
</H2>

<P>這台磁碟機的資料可以在這裡找到：
<A HREF="http://www.iomega.com/zip/products/usb.html">http://www.iomega.com/zip/products/usb.html</A><P>這種磁碟機看起來很酷，而且 USB 介面也看起來很棒。
唯一的問題是目前 Linux 對 USB 介面的驅動程式還在發展中。
因此，就目前而言，這種 ZIP 磁碟機無法在 Linux 下使用。
看看這個網站以取得最新資訊：
<P>
<A HREF="http://peloncho.fis.ucm.es/~inaky/USB/news.html">http://peloncho.fis.ucm.es/~inaky/USB/news.html</A><P>
<H2><A NAME="ss4.8">4.8 ZIP 250 版本 </A>
</H2>

<P>這種機型是 1999 年 1 月推出的新機型。我買了一台，而且在 Linux 下使用非常良好。
所要做的只有使用由 
<A HREF="http://www.torque.net/~campbell/imm.tar.gz">http://www.torque.net/~campbell/imm.tar.gz</A> 取得的 imm 驅動程式。
設定上和 ZIP Plus 相同。簡單的說，先取得驅動程式原始碼，解壓縮，然後執行 make。
接著複製 imm.o 到存放核心模組的目錄下，例如 /lib/modules/2.0.35/scsi（2.0.35 是你的核心版本號碼）。
如果你不確定你的核心版本號碼是多少，可以用 uname -r 指令查詢。
<P>
<P>
<P>
<P>
<HR>
<A HREF="ZIP-Drive-5.html"><IMG SRC="../img/next.gif" ALT="Next"></A>
<A HREF="ZIP-Drive-3.html"><IMG SRC="../img/prev.gif" ALT="Previous"></A>
<A HREF="ZIP-Drive.html#toc4"><IMG SRC="../img/toc.gif" ALT="Contents"></A>
<SCRIPT>EndPage();</SCRIPT>  </BODY>
</HTML>
